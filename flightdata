import numpy as np
import pandas as pd
import matplotlib
import datetime as dt

#Import data from github
url = "https://raw.githubusercontent.com/Zdude-11/ek121-finalproject-shit/main/Detailed_Statistics_Departures%20(1).csv"
flightdata = pd.read_csv(url)
print(flightdata)
modflightdata = flightdata.copy()

#cancelledflightcount = 0
#print(modflightdata["Actual departure time"])
#for i in range(len(modflightdata["Actual departure time"])):
#print(type(flightdata["Actual departure time"]))
    #if modflightdata["Actual departure time"][i] == "00:00":
        # print(flightdata["Flight Number"][i])
        #cancelledflightcount += 1
#print("The number of canceled flights are",cancelledflightcount)

#conversion of the date format to datetime string format
modflightdata["Date (MM/DD/YYYY)"] = pd.to_datetime(modflightdata["Date (MM/DD/YYYY)"], format='%m/%d/%Y')
modflightdata["Scheduled departure time"] = pd.to_datetime(modflightdata["Scheduled departure time"], format='%H:%M')
modflightdata["Actual departure time"] = pd.to_datetime(modflightdata["Actual departure time"], format='%H:%M') 
print(modflightdata.iat[2,5])


print(type(modflightdata["Date (MM/DD/YYYY)"]))
print(modflightdata.iat[2,1], modflightdata.iat[2,5], modflightdata.iat[2,6])
#modflightdata.iat[2,6] - modflightdata.iat[2,5]


for index, row in modflightdata.iterrows():
    modflightdata["Days since 12.20.2022"] =  modflightdata["Date (MM/DD/YYYY)"] - modflightdata.iat[1,1] 
print(modflightdata)


# this line of code is for the comparison between actual mean elapsed flight time and expected mean flight time 

#---------------------code starts here-------------------------------------
#scheduled elapsed time code
scheduled_elapsed_time_in_minutes = 0              
for i in range(len(flightdata["Scheduled elapsed time (Minutes)"])):
    if flightdata["Scheduled elapsed time (Minutes)"][i] > 0:
        scheduled_elapsed_time_in_minutes += flightdata["Scheduled elapsed time (Minutes)"][i]
        count = len(flightdata["Scheduled elapsed time (Minutes)"])
        count += 1
if count > 0:
    mean_scheduled_elapsed_time = scheduled_elapsed_time_in_minutes / count
    print("Mean Scheduled Elapsed Time:", mean_scheduled_elapsed_time)
else:
    print("No positive values in the 'Scheduled elapsed time (Minutes)' column.")
    
#actual elapsed time mean code        
actual_elapsed_time_in_minutes = 0
for i in range(len(flightdata["Actual elapsed time (Minutes)"])):
    if flightdata["Actual elapsed time (Minutes)"][i] > 0:
        actual_elapsed_time_in_minutes += flightdata["Actual elapsed time (Minutes)"][i]
        count = len(flightdata["Actual elapsed time (Minutes)"])
        count += 1
if count > 0:
    mean_actual_elapsed_time = actual_elapsed_time_in_minutes / count
    print("Mean Actual Elapsed Time:", mean_actual_elapsed_time)
else:
    print("No positive values in the 'Actual elapsed time (Minutes)' column.")
               
print(cancelledflightcount)

#-------------------------code ends here-----------------------------
#this is the analysis for the outputs: Our original hypothesis was that the Actual elapsed time in minutes would be greater then the scheduled elapsed time in minutes for flights. But since the Mean scheduled Elapsed Time, in minutes is actual greater than the Mean actual Elapsed Time in minutes we can conclude that the hypothesis was wrong and that Mean actual Elapsed Time, in minutes, is actual less than the scheduled. 
